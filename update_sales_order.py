import pandas as pd
import openpyxl
from openpyxl import load_workbook
from datetime import datetime

# New Sales Order data (user-provided)
sales_order_data = """Sales Order No	Sales Order Item	Unique sales code	Sales Order Date	Comitted Delivery Date	Material Code	Order Quantity	Delivered Qty	Balance Qty
2526100367	10	2526100367-10	2025-07-30	2025-11-01	UBC-035	60	0	60
2526100466	10	2526100466-10	2025-09-05	2025-11-24	UBC-050-YLW-JCB	10	0	10
2526100466	20	2526100466-20	2025-09-05	2025-11-24	UBC-051-YLW-JCB	10	0	10
2526100467	10	2526100467-10	2025-09-05	2025-12-06	UBC-050-YLW-JCB	10	0	10
2526100467	20	2526100467-20	2025-09-05	2025-12-06	UBC-051-YLW-JCB	10	0	10
2526100544	10	2526100544-10	2025-10-10	2025-10-10	PAT-SFP-001-1V	1	0	1
2526100545	10	2526100545-10	2025-10-10	2025-10-10	PAT-SFP-001-1V	1	0	1
2526100552	10	2526100552-10	2025-10-10	2025-10-10	PAT-SFP-001-1V	1	0	1
2526100558	10	2526100558-10	2025-10-13	2025-11-10	ARM-004-N	4	0	4
2526100559	20	2526100559-20	2025-10-13	2025-11-10	ARM-007	1	0	1
2526100560	20	2526100560-20	2025-10-13	2025-11-15	ARM-007	2	0	2
2526100561	10	2526100561-10	2025-10-13	2025-11-10	ARM-004-N	1	0	1
2526100562	10	2526100562-10	2025-10-13	2025-11-18	ARM-004-N	5	0	5
2526100563	10	2526100563-10	2025-10-13	2025-11-26	ARM-004-N	7	0	7
2526100564	20	2526100564-20	2025-10-13	2025-11-15	ARM-007	2	0	2
2526100565	20	2526100565-20	2025-10-13	2025-11-20	ARM-007	4	0	4
2526100566	20	2526100566-20	2025-10-13	2025-11-25	ARM-007	4	0	4
2526100567	20	2526100567-20	2025-10-13	2025-12-01	ARM-007	4	0	4
2526100568	20	2526100568-20	2025-10-13	2025-12-06	ARM-007	4	0	4
2526100569	20	2526100569-20	2025-10-13	2025-11-18	ARM-007	1	0	1
2526100623	10	2526100623-10	2025-11-04	2025-12-20	UBC-050-YLW-JCB	10	0	10
2526100623	20	2526100623-20	2025-11-04	2025-12-20	UBC-051-YLW-JCB	10	0	10
2526100624	10	2526100624-10	2025-11-04	2026-01-10	UBC-050-YLW-JCB	10	0	10
2526100624	20	2526100624-20	2025-11-04	2026-01-10	UBC-051-YLW-JCB	10	0	10
2526200576	10	2526200576-10	2025-04-04	2025-06-22	UBC-062	2	0	2
2526200576	20	2526200576-20	2025-04-04	2025-06-22	UBC-063	2	0	2
2526200576	30	2526200576-30	2025-04-04	2025-06-22	UBC-064	3	0	3
2526201015	10	2526201015-10	2025-05-07	2025-11-15	ATT-001	8	0	8
2526201015	20	2526201015-20	2025-05-07	2025-11-15	ATT-002	8	0	8
2526201075	20	2526201075-20	2025-05-10	2025-11-30	MCB-HYG-050	3	0	3
2526201140	10	2526201140-10	2025-05-12	2025-05-12	PAT4MCB-MLA-048-1V	2	0	2
2526201160	10	2526201160-10	2025-05-14	2025-11-30	MCB-HYG-034	20	0	20
2526201163	10	2526201163-10	2025-05-15	2025-05-15	PAT4MCB-MLA-048-1V	1	0	1
2526201164	10	2526201164-10	2025-05-15	2025-05-15	PAT4MCB-HYG-050-1V	1	0	1
2526201164	20	2526201164-20	2025-05-15	2025-05-15	PAT4MCB-HYG-049-1V	1	0	1
2526201164	30	2526201164-30	2025-05-15	2025-05-15	PAT4MCB-HYG-051-1V	1	0	1
2526201177	10	2526201177-10	2025-05-16	2025-05-16	PAT5NMS-FX-005-1V	1	0	1
2526201341	40	2526201341-40	2025-05-27	2025-11-30	MCB-009	7	0	7
2526201341	50	2526201341-50	2025-05-27	2025-11-30	MCB-JLG-031	1	0	1
2526201353	10	2526201353-10	2025-05-28	2025-11-30	MCB-HYG-062	3	0	3
2526201354	80	2526201354-80	2025-05-28	2025-11-30	MCB-MLA-059	2	0	2
2526201354	90	2526201354-90	2025-05-28	2025-11-30	MCB-MLA-060	2	0	2
2526201561	10	2526201561-10	2025-06-10	2025-11-30	LKK-01	2	0	2
2526201561	20	2526201561-20	2025-06-10	2025-11-30	TAS-GN-006	7	0	7
2526201561	30	2526201561-30	2025-06-10	2025-11-30	ATT-001	1	0	1
2526201611	30	2526201611-30	2025-06-14	2025-11-15	TAS-GN-008	3	0	3
2526201636	10	2526201636-10	2025-06-14	2025-10-31	NMS-FX-005	6	0	6
2526201668	10	2526201668-10	2025-06-17	2025-06-17	PAT4MCB-MLA-063-1V	1	0	1
2526201668	20	2526201668-20	2025-06-17	2025-06-17	PAT4MCB-MLA-064-1V	1	0	1
2526201681	10	2526201681-10	2025-06-18	2025-08-10	UBC-046	8	0	8
2526201804	20	2526201804-20	2025-06-24	2025-11-15	TAS-GN-008	2	0	2
2526202040	20	2526202040-20	2025-07-04	2025-07-04	PAT3NKT-006-1V	1	0	1
2526202458	10	2526202458-10	2025-08-07	2025-11-07	LKK-03	4	0	4
2526202458	20	2526202458-20	2025-08-07	2025-11-07	LKK-04	4	0	4
2526202458	30	2526202458-30	2025-08-07	2025-11-07	LKK-05	4	0	4
2526202458	40	2526202458-40	2025-08-07	2025-11-07	LKK-06	4	0	4
2526202458	50	2526202458-50	2025-08-07	2025-11-07	LKK-01	4	0	4
2526202458	60	2526202458-60	2025-08-07	2025-11-07	LKK-02	4	0	4
2526202459	10	2526202459-10	2025-08-07	2025-11-12	LKK-10	10	0	10
2526202459	20	2526202459-20	2025-08-07	2025-11-12	LKK-11	10	0	10
2526202459	30	2526202459-30	2025-08-07	2025-11-12	LKK-12	10	0	10
2526202474	10	2526202474-10	2025-08-08	2025-11-11	MCB-HYG-026	6	0	6
2526202705	30	2526202705-30	2025-08-22	2025-11-04	MCB-HYG-016	5	0	5
2526202706	30	2526202706-30	2025-08-22	2025-11-04	MCB-HYG-016	5	0	5
2526202707	40	2526202707-40	2025-08-22	2025-11-18	MCB-HYG-016	5	0	5
2526202708	40	2526202708-40	2025-08-22	2025-11-18	MCB-HYG-016	5	0	5
2526202709	50	2526202709-50	2025-08-22	2025-11-04	MCB-HYG-026	6	0	6
2526202713	40	2526202713-40	2025-08-25	2025-11-15	TAS-GN-004	2	0	2
2526202788	10	2526202788-10	2025-08-30	2025-11-18	MCB-HYG-023	6	0	6
2526202810	10	2526202810-10	2025-09-04	2025-10-26	MCB-JLG-046	3	0	3
2526202810	20	2526202810-20	2025-09-04	2025-10-26	MCB-JLG-046	1	0	1
2526202818	10	2526202818-10	2025-09-04	2025-11-25	MCB-HYG-023	6	0	6
2526202819	20	2526202819-20	2025-09-04	2025-12-02	MCB-HYG-016	5	0	5
2526202820	20	2526202820-20	2025-09-04	2025-12-02	MCB-HYG-016	5	0	5
2526202929	10	2526202929-10	2025-09-15	2025-11-15	TAS-GN-008	1	0	1
2526202939	10	2526202939-10	2025-09-15	2025-11-05	NMS-V-004	5	0	5
2526202941	70	2526202941-70	2025-09-16	2025-11-16	UBC-020	2	0	2
2526202943	80	2526202943-80	2025-09-16	2025-11-16	UBC-022	4	0	4
2526202943	90	2526202943-90	2025-09-16	2025-11-23	UBC-022	4	0	4
2526202947	70	2526202947-70	2025-09-16	2025-11-16	UBC-020	4	0	4
2526202947	90	2526202947-90	2025-09-16	2025-11-16	UBC-050	8	0	8
2526202947	100	2526202947-100	2025-09-16	2025-11-16	UBC-051	8	0	8
2526202952	10	2526202952-10	2025-09-16	2025-11-22	ATT-001	8	0	8
2526202952	20	2526202952-20	2025-09-16	2025-11-22	ATT-002	8	0	8
2526202953	10	2526202953-10	2025-09-16	2025-11-22	ATT-001	8	0	8
2526202953	20	2526202953-20	2025-09-16	2025-11-22	ATT-002	8	0	8
2526202954	10	2526202954-10	2025-09-16	2025-12-15	ATT-001	8	0	8
2526202954	20	2526202954-20	2025-09-16	2025-12-15	ATT-002	8	0	8
2526202955	10	2526202955-10	2025-09-16	2025-12-15	ATT-001	8	0	8
2526202955	20	2526202955-20	2025-09-16	2025-12-15	ATT-002	8	0	8
2526202956	10	2526202956-10	2025-09-16	2026-01-15	ATT-001	8	0	8
2526202956	20	2526202956-20	2025-09-16	2026-01-15	ATT-002	8	0	8
2526202957	10	2526202957-10	2025-09-16	2026-01-15	ATT-001	8	0	8
2526202957	20	2526202957-20	2025-09-16	2026-01-15	ATT-002	8	0	8
2526202958	10	2526202958-10	2025-09-16	2026-02-15	ATT-001	8	0	8
2526202958	20	2526202958-20	2025-09-16	2026-02-15	ATT-002	8	0	8
2526202959	10	2526202959-10	2025-09-16	2026-02-15	ATT-001	8	0	8
2526202959	20	2526202959-20	2025-09-16	2026-02-15	ATT-002	8	0	8
2526202960	10	2526202960-10	2025-09-16	2026-03-15	ATT-001	8	0	8
2526202960	20	2526202960-20	2025-09-16	2026-03-15	ATT-002	8	0	8
2526202961	10	2526202961-10	2025-09-16	2026-03-15	ATT-001	8	0	8
2526202961	20	2526202961-20	2025-09-16	2026-03-15	ATT-002	8	0	8
2526202964	10	2526202964-10	2025-09-16	2025-12-04	LKK-01	8	0	8
2526202964	20	2526202964-20	2025-09-16	2025-12-04	LKK-02	8	0	8
2526202964	30	2526202964-30	2025-09-16	2025-12-04	LKK-03	8	0	8
2526202965	10	2526202965-10	2025-09-16	2025-12-11	LKK-01	8	0	8
2526202965	20	2526202965-20	2025-09-16	2025-12-11	LKK-02	8	0	8
2526202965	30	2526202965-30	2025-09-16	2025-12-11	LKK-03	8	0	8
2526202970	40	2526202970-40	2025-09-17	2025-11-10	DGC-001	56	0	56
2526202971	60	2526202971-60	2025-09-17	2025-11-15	DGC-001	56	0	56
2526203022	10	2526203022-10	2025-09-22	2025-11-23	UBC-020	8	0	8
2526203022	20	2526203022-20	2025-09-22	2025-11-23	UBC-022	4	0	4
2526203022	30	2526203022-30	2025-09-22	2025-11-23	UBC-050	4	0	4
2526203022	40	2526203022-40	2025-09-22	2025-11-23	UBC-051	4	0	4
2526203022	50	2526203022-50	2025-09-22	2025-11-23	UBC-022	4	0	4
2526203022	60	2526203022-60	2025-09-22	2025-11-23	UBC-020	8	0	8
2526203023	10	2526203023-10	2025-09-22	2025-11-23	UBC-018	48	0	48
2526203038	40	2526203038-40	2025-09-24	2025-11-19	MCB-009	12	0	12
2526203039	50	2526203039-50	2025-09-24	2025-11-19	MCB-JLG-020	4	0	4
2526203057	10	2526203057-10	2025-09-29	2025-11-15	MCB-JLG-047	11	0	11
2526203076	10	2526203076-10	2025-10-04	2025-11-30	UBC-020	8	0	8
2526203076	20	2526203076-20	2025-10-04	2025-11-30	UBC-022	4	0	4
2526203076	30	2526203076-30	2025-10-04	2025-11-30	UBC-050	4	0	4
2526203076	40	2526203076-40	2025-10-04	2025-11-30	UBC-051	4	0	4
2526203078	10	2526203078-10	2025-10-04	2025-11-30	UBC-014	50	0	50
2526203090	10	2526203090-10	2025-10-04	2025-11-03	NMS-V-004	5	0	5
2526203091	10	2526203091-10	2025-10-04	2025-11-10	NMS-V-004	5	0	5
2526203092	20	2526203092-20	2025-10-04	2025-11-06	NMS-H-001	13	0	13
2526203093	20	2526203093-20	2025-10-04	2025-11-10	NMS-H-001	13	0	13
2526203094	30	2526203094-30	2025-10-04	2025-11-06	NMS-V-003	10	0	10
2526203095	10	2526203095-10	2025-10-04	2025-12-15	LKK-10	10	0	10
2526203095	20	2526203095-20	2025-10-04	2025-12-15	LKK-11	10	0	10
2526203095	30	2526203095-30	2025-10-04	2025-12-15	LKK-12	10	0	10
2526203096	10	2526203096-10	2025-10-04	2025-12-20	LKK-10	10	0	10
2526203096	20	2526203096-20	2025-10-04	2025-12-20	LKK-11	10	0	10
2526203096	30	2526203096-30	2025-10-04	2025-12-20	LKK-12	10	0	10
2526203097	10	2526203097-10	2025-10-04	2025-12-24	LKK-10	10	0	10
2526203097	20	2526203097-20	2025-10-04	2025-12-24	LKK-11	10	0	10
2526203097	30	2526203097-30	2025-10-04	2025-12-24	LKK-12	10	0	10
2526203098	10	2526203098-10	2025-10-04	2025-12-29	LKK-10	10	0	10
2526203098	20	2526203098-20	2025-10-04	2025-12-29	LKK-11	10	0	10
2526203098	30	2526203098-30	2025-10-04	2025-12-29	LKK-12	10	0	10
2526203099	10	2526203099-10	2025-10-04	2026-01-04	LKK-01	4	0	4
2526203099	20	2526203099-20	2025-10-04	2026-01-04	LKK-02	4	0	4
2526203099	30	2526203099-30	2025-10-04	2026-01-04	LKK-03	4	0	4
2526203099	40	2526203099-40	2025-10-04	2026-01-04	LKK-10	4	0	4
2526203099	50	2526203099-50	2025-10-04	2026-01-04	LKK-11	4	0	4
2526203099	60	2526203099-60	2025-10-04	2026-01-04	LKK-12	4	0	4
2526203103	10	2526203103-10	2025-10-07	2025-12-29	NMS-V-004	5	0	5
2526203131	40	2526203131-40	2025-10-07	2025-12-03	MCB-JLG-014	6	0	6
2526203138	70	2526203138-70	2025-10-07	2025-12-03	MCB-009	12	0	12
2526203139	80	2526203139-80	2025-10-07	2025-11-26	MCB-009	12	0	12
2526203140	90	2526203140-90	2025-10-07	2025-12-03	MCB-JLG-047	11	0	11
2526203141	100	2526203141-100	2025-10-07	2025-11-26	MCB-JLG-047	11	0	11
2526203142	110	2526203142-110	2025-10-07	2025-12-03	MCB-JLG-020	4	0	4
2526203143	120	2526203143-120	2025-10-07	2025-11-26	MCB-JLG-020	4	0	4
2526203148	10	2526203148-10	2025-10-08	2025-12-31	NMS-V-004	5	0	5
2526203153	10	2526203153-10	2025-10-09	2025-12-02	MCB-008	6	0	6
2526203154	10	2526203154-10	2025-10-09	2025-12-02	MCB-008	6	0	6
2526203163	10	2526203163-10	2025-10-10	2025-12-03	MCB-JLG-014	6	0	6
2526203164	20	2526203164-20	2025-10-10	2025-12-03	MCB-008	6	0	6
2526203171	70	2526203171-70	2025-10-10	2025-12-05	MCB-010	7	0	7
2526203172	70	2526203172-70	2025-10-10	2025-12-05	MCB-010	7	0	7
2526203173	70	2526203173-70	2025-10-10	2025-12-05	MCB-010	7	0	7
2526203174	70	2526203174-70	2025-10-10	2025-12-05	MCB-010	7	0	7
2526203175	80	2526203175-80	2025-10-10	2025-12-03	MCB-010	7	0	7
2526203176	80	2526203176-80	2025-10-10	2025-12-03	MCB-010	7	0	7
2526203177	80	2526203177-80	2025-10-10	2025-12-03	MCB-010	7	0	7
2526203236	10	2526203236-10	2025-10-16	2025-12-22	ATT-002	28	0	28
2526203249	10	2526203249-10	2025-10-16	2025-12-02	MCB-JLG-019	15	0	15
2526203250	20	2526203250-20	2025-10-16	2025-12-05	MCB-JLG-019	15	0	15
2526203251	20	2526203251-20	2025-10-16	2025-12-05	MCB-JLG-019	15	0	15
2526203252	10	2526203252-10	2025-10-16	2025-12-09	MCB-HYG-023	6	0	6
2526203253	20	2526203253-20	2025-10-16	2025-12-09	MCB-HYG-015	8	0	8
2526203255	10	2526203255-10	2025-10-17	2025-12-10	MCB-008	6	0	6
2526203256	20	2526203256-20	2025-10-17	2025-12-10	MCB-007	4	0	4
2526203258	40	2526203258-40	2025-10-17	2025-12-10	MCB-JLG-033	4	0	4
2526203259	50	2526203259-50	2025-10-17	2025-12-31	MCB-009	12	0	12
2526203260	60	2526203260-60	2025-10-17	2025-12-10	MCB-010	7	0	7
2526203261	70	2526203261-70	2025-10-17	2025-12-10	MCB-JLG-014	6	0	6
2526203262	80	2526203262-80	2025-10-17	2025-12-10	MCB-JLG-014	6	0	6
2526203269	10	2526203269-10	2025-10-23	2025-11-18	DGC-001	56	0	56
2526203270	10	2526203270-10	2025-10-23	2025-11-25	DGC-001	34	0	34
2526203270	30	2526203270-30	2025-10-23	2025-11-25	DGC-011	4	0	4
2526203271	10	2526203271-10	2025-10-23	2025-11-30	DGC-001	38	0	38
2526203271	20	2526203271-20	2025-10-23	2025-11-30	DGC-012	36	0	36
2526203274	10	2526203274-10	2025-10-23	2025-12-15	DGC-001	56	0	56
2526203276	10	2526203276-10	2025-10-23	2025-12-21	DGC-001	34	0	34
2526203276	30	2526203276-30	2025-10-23	2025-12-21	DGC-011	4	0	4
2526203277	10	2526203277-10	2025-10-23	2025-12-26	DGC-001	56	0	56
2526203279	40	2526203279-40	2025-10-23	2025-11-26	MCB-JLG-014	6	0	6
2526203280	10	2526203280-10	2025-10-23	2025-12-31	DGC-001	56	0	56
2526203284	60	2526203284-60	2025-10-23	2025-11-26	MCB-007	4	0	4
2526203285	60	2526203285-60	2025-10-23	2025-11-26	MCB-007	4	0	4
2526203286	60	2526203286-60	2025-10-23	2025-11-26	MCB-007	4	0	4
2526203287	70	2526203287-70	2025-10-23	2025-12-02	MCB-JLG-014	6	0	6
2526203310	10	2526203310-10	2025-10-25	2025-12-14	UBC-022	8	0	8
2526203310	20	2526203310-20	2025-10-25	2025-12-14	UBC-050	4	0	4
2526203310	30	2526203310-30	2025-10-25	2025-12-14	UBC-051	4	0	4
2526203310	40	2526203310-40	2025-10-25	2025-12-14	UBC-021	2	0	2
2526203311	30	2526203311-30	2025-10-25	2025-12-14	UBC-019	14	0	14
2526203312	20	2526203312-20	2025-10-25	2025-12-14	UBC-018	36	0	36
2526203312	30	2526203312-30	2025-10-25	2025-12-14	UBC-019	1	0	1
2526203312	40	2526203312-40	2025-10-25	2025-12-14	UBC-019	1	0	1
2526203331	10	2526203331-10	2025-10-28	2025-12-21	UBC-022	8	0	8
2526203331	20	2526203331-20	2025-10-28	2025-12-21	UBC-050	4	0	4
2526203331	30	2526203331-30	2025-10-28	2025-12-21	UBC-051	4	0	4
2526203331	40	2526203331-40	2025-10-28	2025-12-21	UBC-021	2	0	2
2526203332	10	2526203332-10	2025-10-29	2025-11-29	DGC-006	10	0	10
2526203332	20	2526203332-20	2025-10-29	2025-11-29	DGC-009	14	0	14
2526203370	20	2526203370-20	2025-10-30	2025-12-17	MCB-JLG-047	11	0	11
2526203373	50	2526203373-50	2025-10-30	2025-12-17	MCB-JLG-019	15	0	15
2526203374	60	2526203374-60	2025-10-30	2025-12-17	MCB-JLG-020	4	0	4
2526203375	70	2526203375-70	2025-10-30	2025-12-17	MCB-007	4	0	4
2526203376	70	2526203376-70	2025-10-30	2025-12-17	MCB-007	4	0	4
2526203377	70	2526203377-70	2025-10-30	2025-12-17	MCB-007	4	0	4
2526203378	70	2526203378-70	2025-10-30	2025-12-17	MCB-007	4	0	4
2526203379	70	2526203379-70	2025-10-30	2025-12-17	MCB-007	4	0	4
2526203380	70	2526203380-70	2025-10-30	2025-12-17	MCB-007	4	0	4
2526203381	70	2526203381-70	2025-10-30	2025-12-17	MCB-007	4	0	4
2526203382	70	2526203382-70	2025-10-30	2025-12-17	MCB-007	4	0	4
2526203383	70	2526203383-70	2025-10-30	2025-12-17	MCB-007	4	0	4
2526203384	70	2526203384-70	2025-10-30	2025-12-17	MCB-007	4	0	4
2526203385	70	2526203385-70	2025-10-30	2025-12-17	MCB-007	4	0	4
2526203386	80	2526203386-80	2025-10-30	2025-12-08	MCB-007	4	0	4
2526203387	80	2526203387-80	2025-10-30	2025-12-08	MCB-007	4	0	4
2526203388	90	2526203388-90	2025-10-30	2025-12-03	MCB-JLG-032	4	0	4
2526203389	100	2526203389-100	2025-10-30	2025-12-17	MCB-JLG-047	11	0	11
2526203390	110	2526203390-110	2025-10-30	2025-12-31	MCB-009	12	0	12
2526203394	150	2526203394-150	2025-10-30	2025-12-17	MCB-008	6	0	6
2526203396	10	2526203396-10	2025-10-30	2025-12-08	MCB-010	7	0	7
2526203397	10	2526203397-10	2025-10-30	2025-12-08	MCB-010	7	0	7
2526203398	10	2526203398-10	2025-10-30	2025-12-16	MCB-HYG-023	6	0	6
2526203427	10	2526203427-10	2025-11-04	2025-12-28	UBC-022	8	0	8
2526203427	20	2526203427-20	2025-11-04	2025-12-28	UBC-050	4	0	4
2526203427	30	2526203427-30	2025-11-04	2025-12-28	UBC-051	4	0	4
2526203427	40	2526203427-40	2025-11-04	2025-12-28	UBC-021	2	0	2
2526203434	10	2526203434-10	2025-11-05	2025-11-05	UBC-064	2	0	2
2526203454	40	2526203454-40	2025-11-08	2025-12-10	TAS-GN-029	6	0	6
2526203454	50	2526203454-50	2025-11-08	2025-12-10	TAS-GN-029	12	0	12
2526203454	60	2526203454-60	2025-11-08	2025-12-10	TAS-GN-021	12	0	12
2526203454	100	2526203454-100	2025-11-08	2025-12-10	TAS-GN-029	12	0	12
2526203455	10	2526203455-10	2025-11-08	2025-12-15	TAS-GN-010	2	0	2
2526203455	20	2526203455-20	2025-11-08	2025-12-15	TAS-GN-011	2	0	2
2526203455	30	2526203455-30	2025-11-08	2025-12-15	TAS-GN-021	14	0	14
2526203455	40	2526203455-40	2025-11-08	2025-12-15	TAS-GN-029	3	0	3
2526203456	30	2526203456-30	2025-11-08	2025-12-10	TAS-GN-012	9	0	9
2526203456	50	2526203456-50	2025-11-08	2025-12-10	TAS-GN-008	1	0	1
2526203457	30	2526203457-30	2025-11-08	2025-12-15	TAS-GN-012	10	0	10
2526203458	30	2526203458-30	2025-11-08	2025-12-20	TAS-GN-012	10	0	10
2526203459	10	2526203459-10	2025-11-08	2025-12-10	TAS-GN-014	10	0	10
2526203459	40	2526203459-40	2025-11-08	2025-12-10	TAS-GN-007	20	0	20
2526203459	50	2526203459-50	2025-11-08	2025-12-10	TAS-GN-009	20	0	20
2526203459	60	2526203459-60	2025-11-08	2025-12-10	TAS-GN-006	9	0	9
2526203460	10	2526203460-10	2025-11-08	2025-12-15	TAS-GN-004	9	0	9
2526203461	10	2526203461-10	2025-11-08	2025-12-20	TAS-GN-004	6	0	6
2526203461	20	2526203461-20	2025-11-08	2025-12-20	TAS-GN-008	3	0	3
2526203462	20	2526203462-20	2025-11-08	2025-12-20	TAS-GN-008	3	0	3
2526203462	30	2526203462-30	2025-11-08	2025-12-20	TAS-GN-008	6	0	6
2526203463	10	2526203463-10	2025-11-08	2025-11-29	LKK-04	4	0	4
2526203463	20	2526203463-20	2025-11-08	2025-11-29	LKK-05	4	0	4
2526203463	30	2526203463-30	2025-11-08	2025-11-29	LKK-06	4	0	4
2526203463	40	2526203463-40	2025-11-08	2025-11-29	LKK-16	12	0	12
2526203463	50	2526203463-50	2025-11-08	2025-11-29	LKK-17	12	0	12
2526203464	10	2526203464-10	2025-11-08	2025-12-07	LKK-033	6	0	6
2526203464	20	2526203464-20	2025-11-08	2025-12-07	LKK-034	3	0	3
2526203464	30	2526203464-30	2025-11-08	2025-12-07	LKK-030	3	0	3
2526203464	40	2526203464-40	2025-11-08	2025-12-07	LKK-031	3	0	3
2526203464	50	2526203464-50	2025-11-08	2025-12-07	LKK-032	3	0	3
2526203465	10	2526203465-10	2025-11-08	2025-12-13	LKK-035	9	0	9
2526203482	10	2526203482-10	2025-11-11	2026-01-04	UBC-022	8	0	8
2526203482	20	2526203482-20	2025-11-11	2026-01-04	UBC-050	4	0	4
2526203482	30	2526203482-30	2025-11-11	2026-01-04	UBC-051	4	0	4
2526203482	40	2526203482-40	2025-11-11	2026-01-04	UBC-021	2	0	2
2526203484	10	2526203484-10	2025-11-11	2026-01-04	UBC-014	50	0	50
2526203547	10	2526203547-10	2025-11-20	2026-01-11	UBC-020	4	0	4
2526203547	20	2526203547-20	2025-11-20	2026-01-11	UBC-050	12	0	12
2526203547	30	2526203547-30	2025-11-20	2026-01-11	UBC-051	12	0	12
2526203547	40	2526203547-40	2025-11-20	2026-01-11	UBC-021	2	0	2
2526203549	40	2526203549-40	2025-11-21	2026-01-03	DGC-001	56	0	56
2526203550	50	2526203550-50	2025-11-21	2026-01-10	DGC-001	56	0	56
2526203551	60	2526203551-60	2025-11-21	2026-01-13	DGC-001	56	0	56
2526203552	70	2526203552-70	2025-11-21	2026-01-20	DGC-001	56	0	56
2526203553	80	2526203553-80	2025-11-21	2026-01-27	DGC-001	56	0	56
2526203554	10	2526203554-10	2025-11-21	2026-01-07	DGC-012	40	0	40
2526203554	20	2526203554-20	2025-11-21	2026-01-07	DGC-011	6	0	6
2526203555	10	2526203555-10	2025-11-21	2026-01-16	DGC-012	40	0	40
2526203555	20	2526203555-20	2025-11-21	2026-01-16	DGC-011	6	0	6
2526203556	10	2526203556-10	2025-11-21	2026-01-23	DGC-012	34	0	34
2526203556	20	2526203556-20	2025-11-21	2026-01-23	DGC-011	5	0	5
2526203556	30	2526203556-30	2025-11-21	2026-01-23	DGC-001	12	0	12
2526500083	10	2526500083-10	2025-08-24	2025-10-16	KBS-012	11	10	1
2526500086	10	2526500086-10	2025-08-24	2025-10-15	KBS-016	24	0	24
2526500087	20	2526500087-20	2025-08-24	2025-10-22	KBS-017	23	17	6
2526500091	40	2526500091-40	2025-08-24	2025-11-03	KBS-018	24	12	12
2526500092	20	2526500092-20	2025-09-03	2025-11-10	KBS-017	2	0	2
2526500093	10	2526500093-10	2025-09-03	2025-11-22	KBS-018	24	0	24
2526500094	10	2526500094-10	2025-09-03	2025-11-10	KBS-017	20	0	20
2526500095	10	2526500095-10	2025-09-03	2025-11-17	KBS-017	22	0	22
2526500096	10	2526500096-10	2025-09-03	2025-11-24	KBS-017	18	0	18
2526500097	10	2526500097-10	2025-09-03	2025-11-24	KBS-017	4	0	4
2526500098	10	2526500098-10	2025-09-03	2025-12-01	KBS-017	22	0	22
2526500099	10	2526500099-10	2025-09-03	2025-12-08	KBS-017	22	0	22
2526500102	10	2526500102-10	2025-09-24	2025-10-10	KBS-013	24	0	24
2526500104	10	2526500104-10	2025-10-07	2025-11-20	KBS-016	24	0	24
2526500105	10	2526500105-10	2025-10-07	2025-11-20	KBS-016	24	0	24
2526500106	10	2526500106-10	2025-10-10	2025-12-01	KBS-017	12	0	12
2526500107	10	2526500107-10	2025-10-10	2025-10-25	KBS-014	24	0	24
2526500109	10	2526500109-10	2025-10-15	2025-11-22	KBS-008	22	0	22
2526500110	10	2526500110-10	2025-10-15	2025-12-12	KBS-016	24	0	24
2526500111	20	2526500111-20	2025-10-15	2025-12-16	KBS-017	20	0	20
2526500112	20	2526500112-20	2025-10-15	2025-12-18	KBS-017	20	0	20
2526500113	20	2526500113-20	2025-10-15	2025-12-24	KBS-017	20	0	20
2526500114	10	2526500114-10	2025-10-15	2025-11-25	KBS-009	20	0	20
2526500115	20	2526500115-20	2025-10-15	2025-11-27	KBS-010	16	0	16
2526500116	30	2526500116-30	2025-10-15	2025-11-27	KBS-011	15	0	15
2526500117	10	2526500117-10	2025-10-15	2025-12-26	KBS-009	2	0	2
2526500118	20	2526500118-20	2025-10-15	2025-12-26	KBS-010	4	0	4
2526500119	30	2526500119-30	2025-10-15	2025-12-26	KBS-011	1	0	1
2526500120	10	2526500120-10	2025-10-15	2025-11-30	KBS-009	20	0	20
2526500121	10	2526500121-10	2025-10-15	2025-12-26	KBS-009	2	0	2
2526500122	20	2526500122-20	2025-10-15	2025-12-03	KBS-011	15	0	15
2526500123	20	2526500123-20	2025-10-15	2025-12-26	KBS-011	1	0	1
2526500124	10	2526500124-10	2025-10-25	2025-11-26	KBS-009	20	0	20
2526500125	20	2526500125-20	2025-10-25	2025-11-29	KBS-011	15	0	15
2526500126	10	2526500126-10	2025-10-25	2025-11-30	KBS-012	24	0	24
2526500127	10	2526500127-10	2025-10-25	2025-12-03	KBS-012	24	0	24
2526500128	20	2526500128-20	2025-10-28	2025-12-03	KBS-013	24	0	24
2526500129	20	2526500129-20	2025-10-28	2025-12-10	KBS-013	24	0	24
2526500130	30	2526500130-30	2025-10-28	2025-12-03	KBS-014	24	0	24
2526500131	30	2526500131-30	2025-10-28	2025-12-10	KBS-014	24	0	24"""

# Parse the data
from io import StringIO
df_new = pd.read_csv(StringIO(sales_order_data), sep='\t')

# Convert date columns
df_new['Sales Order Date'] = pd.to_datetime(df_new['Sales Order Date'])
df_new['Comitted Delivery Date'] = pd.to_datetime(df_new['Comitted Delivery Date'])

print(f"Loaded {len(df_new)} sales order rows")
print(f"\nDate range: {df_new['Comitted Delivery Date'].min()} to {df_new['Comitted Delivery Date'].max()}")

# Count past-due orders (before 2025-11-21)
planning_date = datetime(2025, 11, 21)
past_due = df_new[df_new['Comitted Delivery Date'] < planning_date]
print(f"\nPast-due orders (before {planning_date.date()}): {len(past_due)}")
print(f"  Earliest past-due: {past_due['Comitted Delivery Date'].min()}")
print(f"  Total past-due quantity: {past_due['Balance Qty'].sum()} units")

# Update the Excel file
excel_file = 'Master_Data_Updated_Nov_Dec.xlsx'
wb = load_workbook(excel_file)

# Replace Sales Order sheet
if 'Sales Order' in wb.sheetnames:
    del wb['Sales Order']

ws = wb.create_sheet('Sales Order', 0)  # Insert at beginning

# Write headers
headers = df_new.columns.tolist()
for col_idx, header in enumerate(headers, 1):
    ws.cell(row=1, column=col_idx, value=header)

# Write data
for row_idx, row in enumerate(df_new.itertuples(index=False), 2):
    for col_idx, value in enumerate(row, 1):
        ws.cell(row=row_idx, column=col_idx, value=value)

# Save
wb.save(excel_file)
print(f"\n✓ Updated {excel_file} with {len(df_new)} sales orders")
print(f"✓ Sales Order sheet replaced")
